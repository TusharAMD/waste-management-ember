/*!
 * Particleground
 *
 * @author Jonathan Nicol - @mrjnicol
 * @version 1.1.0
 * @description Creates a canvas based particle system background
 *
 * Inspired by http://requestlab.fr/ and http://disruptivebydesign.com/
 */
!function(h,g){function l(f){f=f||{};for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n){for(var m in n){n.hasOwnProperty(m)&&("object"==typeof n[m]?deepExtend(f[m],n[m]):f[m]=n[m])}}}return f}function k(ad,ac){function ab(){if(b){P=g.createElement("canvas"),P.className="pg-canvas",P.style.display="block",ad.insertBefore(P,ad.firstChild),N=P.getContext("2d"),aa();for(var n=Math.round(P.width*P.height/ac.density),m=0;n>m;m++){var d=new V;d.setStackPos(m),a.push(d)}h.addEventListener("resize",function(){Y()},!1),g.addEventListener("mousemove",function(o){S=o.pageX,Q=o.pageY},!1),M&&!O&&h.addEventListener("deviceorientation",function(){I=Math.min(Math.max(-event.beta,-30),30),K=Math.min(Math.max(-event.gamma,-30),30)},!0),Z(),R("onInit")}}function aa(){P.width=ad.offsetWidth,P.height=ad.offsetHeight,N.fillStyle=ac.dotColor,N.strokeStyle=ac.lineColor,N.lineWidth=ac.lineWidth}function Z(){if(b){J=h.innerWidth,H=h.innerHeight,N.clearRect(0,0,P.width,P.height);for(var d=0;d<a.length;d++){a[d].updatePosition()}for(var d=0;d<a.length;d++){a[d].draw()}f||(L=requestAnimationFrame(Z))}}function Y(){aa();for(var m=ad.offsetWidth,d=ad.offsetHeight,p=a.length-1;p>=0;p--){(a[p].position.x>m||a[p].position.y>d)&&a.splice(p,1)}var o=Math.round(P.width*P.height/ac.density);if(o>a.length){for(;o>a.length;){var n=new V;a.push(n)}}else{o<a.length&&a.splice(o)}for(p=a.length-1;p>=0;p--){a[p].setStackPos(p)}}function X(){f=!0}function W(){f=!1,Z()}function V(){switch(this.stackPos,this.active=!0,this.layer=Math.ceil(3*Math.random()),this.parallaxOffsetX=0,this.parallaxOffsetY=0,this.position={x:Math.ceil(Math.random()*P.width),y:Math.ceil(Math.random()*P.height)},this.speed={},ac.directionX){case"left":this.speed.x=+(-ac.maxSpeedX+Math.random()*ac.maxSpeedX-ac.minSpeedX).toFixed(2);break;case"right":this.speed.x=+(Math.random()*ac.maxSpeedX+ac.minSpeedX).toFixed(2);break;default:this.speed.x=+(-ac.maxSpeedX/2+Math.random()*ac.maxSpeedX).toFixed(2),this.speed.x+=this.speed.x>0?ac.minSpeedX:-ac.minSpeedX}switch(ac.directionY){case"up":this.speed.y=+(-ac.maxSpeedY+Math.random()*ac.maxSpeedY-ac.minSpeedY).toFixed(2);break;case"down":this.speed.y=+(Math.random()*ac.maxSpeedY+ac.minSpeedY).toFixed(2);break;default:this.speed.y=+(-ac.maxSpeedY/2+Math.random()*ac.maxSpeedY).toFixed(2),this.speed.x+=this.speed.y>0?ac.minSpeedY:-ac.minSpeedY}}function U(m,d){return d?void (ac[m]=d):ac[m]}function T(){console.log("destroy"),P.parentNode.removeChild(P),R("onDestroy"),i&&i(ad).removeData("plugin_"+j)}function R(d){void 0!==ac[d]&&ac[d].call(ad)}var P,N,L,J,H,e,c,b=!!g.createElement("canvas").getContext,a=[],S=0,Q=0,O=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i),M=!!h.DeviceOrientationEvent,K=0,I=0,f=!1;return ac=l({},h[j].defaults,ac),V.prototype.draw=function(){N.beginPath(),N.arc(this.position.x+this.parallaxOffsetX,this.position.y+this.parallaxOffsetY,ac.particleRadius/2,0,2*Math.PI,!0),N.closePath(),N.fill(),N.beginPath();for(var n=a.length-1;n>this.stackPos;n--){var m=a[n],q=this.position.x-m.position.x,p=this.position.y-m.position.y,o=Math.sqrt(q*q+p*p).toFixed(2);o<ac.proximity&&(N.moveTo(this.position.x+this.parallaxOffsetX,this.position.y+this.parallaxOffsetY),ac.curvedLines?N.quadraticCurveTo(Math.max(m.position.x,m.position.x),Math.min(m.position.y,m.position.y),m.position.x+m.parallaxOffsetX,m.position.y+m.parallaxOffsetY):N.lineTo(m.position.x+m.parallaxOffsetX,m.position.y+m.parallaxOffsetY))}N.stroke(),N.closePath()},V.prototype.updatePosition=function(){if(ac.parallax){if(M&&!O){var m=(J-0)/60;e=(K- -30)*m+0;var d=(H-0)/60;c=(I- -30)*d+0}else{e=S,c=Q}this.parallaxTargX=(e-J/2)/(ac.parallaxMultiplier*this.layer),this.parallaxOffsetX+=(this.parallaxTargX-this.parallaxOffsetX)/10,this.parallaxTargY=(c-H/2)/(ac.parallaxMultiplier*this.layer),this.parallaxOffsetY+=(this.parallaxTargY-this.parallaxOffsetY)/10}var o=ad.offsetWidth,n=ad.offsetHeight;switch(ac.directionX){case"left":this.position.x+this.speed.x+this.parallaxOffsetX<0&&(this.position.x=o-this.parallaxOffsetX);break;case"right":this.position.x+this.speed.x+this.parallaxOffsetX>o&&(this.position.x=0-this.parallaxOffsetX);break;default:(this.position.x+this.speed.x+this.parallaxOffsetX>o||this.position.x+this.speed.x+this.parallaxOffsetX<0)&&(this.speed.x=-this.speed.x)}switch(ac.directionY){case"up":this.position.y+this.speed.y+this.parallaxOffsetY<0&&(this.position.y=n-this.parallaxOffsetY);break;case"down":this.position.y+this.speed.y+this.parallaxOffsetY>n&&(this.position.y=0-this.parallaxOffsetY);break;default:(this.position.y+this.speed.y+this.parallaxOffsetY>n||this.position.y+this.speed.y+this.parallaxOffsetY<0)&&(this.speed.y=-this.speed.y)}this.position.x+=this.speed.x,this.position.y+=this.speed.y},V.prototype.setStackPos=function(d){this.stackPos=d},ab(),{option:U,destroy:T,start:W,pause:X}}var j="particleground",i=h.jQuery;h[j]=function(d,c){return new k(d,c)},h[j].defaults={minSpeedX:0.1,maxSpeedX:0.7,minSpeedY:0.1,maxSpeedY:0.7,directionX:"center",directionY:"center",density:10000,dotColor:"#666666",lineColor:"#666666",particleRadius:7,lineWidth:1,curvedLines:!1,proximity:100,parallax:!0,parallaxMultiplier:5,onInit:function(){},onDestroy:function(){}},i&&(i.fn[j]=function(e){if("string"==typeof arguments[0]){var d,m=arguments[0],f=Array.prototype.slice.call(arguments,1);return this.each(function(){i.data(this,"plugin_"+j)&&"function"==typeof i.data(this,"plugin_"+j)[m]&&(d=i.data(this,"plugin_"+j)[m].apply(this,f))}),void 0!==d?d:this}return"object"!=typeof e&&e?void 0:this.each(function(){i.data(this,"plugin_"+j)||i.data(this,"plugin_"+j,new k(this,e))})})}(window,document),function(){for(var e=0,d=["ms","moz","webkit","o"],f=0;f<d.length&&!window.requestAnimationFrame;++f){window.requestAnimationFrame=window[d[f]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[f]+"CancelAnimationFrame"]||window[d[f]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var i=(new Date).getTime(),h=Math.max(0,16-(i-e)),g=window.setTimeout(function(){a(i+h)},h);return e=i+h,g}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(b){clearTimeout(b)})}();jQuery.noConflict();jQuery(document).ready(function(a){a("#particle-ground").particleground({dotColor:"#ffffff",lineColor:"#ffffff",density:9000,particleRadius:7,lineWidth:1,curvedLines:false,proximity:100,lineWidth:0.2});
});